# 03 | 复杂度分析

## 复杂度分析（上）：如何分析、统计算法的执行效率和资源消耗？

复杂度分析是整个算法学习的精髓


### 一、什么是复杂度分析？
1. 数据结构和算法解决是“如何让计算机更快时间、更省空间的解决问题”。
2. 因此需从**执行时间**和**占用空间**两个维度来评估数据结构和算法的性能。
3. 分别用**时间复杂度**和**空间复杂度**两个概念来描述性能问题，二者统称为复杂度。
4. 复杂度描述的是**算法执行时间（或占用空间）与数据规模的增长之间的关系**。


### 二、为什么要进行复杂度分析？
1. 和性能测试相比，复杂度分析有不依赖执行环境、成本低、效率高、易操作、指导性强的特点。
2. 掌握复杂度分析，将能编写出性能更优的代码，有利于降低系统开发和维护成本。


### 三、事后统计法的局限性
1. 测试结果非常依赖测试环境
2. 测试结果受数据规模的影响很大


### 四、大O表示法

所有代码的执行时间 T(n) 与每行代码的执行次数 n 成正比。即：

**T(n) = O(f(n))**

其中，T(n)=表示代码执行的时间；n 表示数据规模的大小；f(n) 表示每行代码执行的次数总和。因为这是一个公式，所以用 f(n) 来表示。公式中的 O，表示代码的执行时间 T(n) 与 f(n) 表达式成正比。

大 O 时间复杂度实际上并不具体表示代码真正的执行时间，而是**表示代码执行时间随数据规模增长的变化趋势**，所以，也叫作**渐进时间复杂度（asymptotic time complexity）**，简称**时间复杂度**。


### 五、时间复杂度分析方法

1. 只关注循环执行次数最多的一段代码 （循环）

    大 O 复杂度表示方法只是表示一种变化趋势，我们通常会忽略掉公式中的常量、低阶、系数，只需要记录一个最大阶的量级就可以了。

    所以，我们在分析一个算法、一段代码的时间复杂度的时候，也只关注**循环执行次数最多**的那一段代码就可以了。这段核心代码执行次数的 n 的量级，就是整段要分析代码的时间复杂度。

2. 加法法则：总复杂度等于**量级最大**的那段代码的复杂度
    
    多段代码取时间复杂度最大的。比如一段代码中有单循环和多重循环，那么取多重循环的复杂度。
    总的时间复杂度就等于**量级最大**的那段代码的时间复杂度。

3. 乘法法则：嵌套代码的复杂度等于嵌套内外代码复杂度的乘积

    假设 T1(n) = O(n)，T2(n) = O(n^2)，则 T1(n) * T2(n) = O(n^3)。
    如嵌套循环、递归。


### 六、几种常用的时间复杂度
- 多项式阶：

    随着数据规模的增长，算法的执行时间和空间占用，按照多项式的比例增长。包括，
    O(1)（常数阶）、O(logn)（对数阶）、O(n)（线性阶）、O(nlogn)（线性对数阶）、O(n^2)（平方阶）、O(n^3)（立方阶）

    O(1) < O(logn) < O(n) < O(nlogn) < O(n^2) < O(n^3)

- 非多项式阶：

    随着数据规模的增长，算法的执行时间和空间占用暴增，这类算法性能极差。包括，
    O(2^n)（指数阶）、O(n!)（阶乘阶）

    我们把时间复杂度为非多项式量级的算法问题叫作 **NP（Non-Deterministic Polynomial，非确定多项式）问题**。


### 七、空间复杂度分析
时间复杂度的全称是渐进时间复杂度，表示算法的执行时间与数据规模之间的增长关系。类比一下，空间复杂度全称就是**渐进空间复杂度（asymptotic space complexity）**，表示算法的**存储空间**与数据规模之间的增长关系。

常见的空间复杂度就是 O(1)、O(n)、O(n2 )，像 O(logn)、O(nlogn)这样的对数阶复杂度平时都用不到。


----------


## 复杂度分析（下）：浅析最好、最坏、平均、均摊时间复杂度

### 一、复杂度分析的4个概念
1. 最坏情况时间复杂度：代码在**最理想情况**下执行的时间复杂度。
2. 最好情况时间复杂度：代码在**最坏情况**下执行的时间复杂度。
3. 平均时间复杂度：用代码在所有情况下执行的次数的**加权平均值**表示。
4. 均摊时间复杂度：在代码执行的所有复杂度情况中**绝大部分是低级别的复杂度，个别情况是高级别复杂度且发生具有时序关系**时，可以将个别高级别复杂度均摊到低级别复杂度上。基本上均摊结果就等于低级别复杂度。


### 二、为什么要引入这4个概念？
1. 同一段代码在不同情况下时间复杂度会出现量级差异，为了更全面，更准确的描述代码的时间复杂度，所以引入这4个概念。
2. 代码复杂度在不同情况下出现量级差别时才需要区别这四种复杂度。大多数情况下，是不需要区别分析它们的。

### 三、如何分析平均、均摊时间复杂度？
1. 平均时间复杂度
    代码在不同情况下复杂度出现量级差别，则用代码所有可能情况下执行次数的加权平均值表示。

2. 均摊时间复杂度在满足两个条件时使用：
    1. 代码在绝大多数情况下是低级别复杂度，只有极少数情况是高级别复杂度；
    2. 低级别和高级别复杂度出现具有时序规律。均摊结果一般都等于低级别复杂度。